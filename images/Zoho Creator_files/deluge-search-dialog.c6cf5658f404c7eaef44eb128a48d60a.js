(function(e){DRE.serviceFlags.isEnabled("amd-modules")?"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror):e(CodeMirror)})(function(e){function z(b,c,a){b=b.getWrapperElement().appendChild(document.createElement("div"));b.className=a?"CodeMirror-dialog CodeMirror-dialog-bottom":"CodeMirror-dialog CodeMirror-dialog-top";"string"==typeof c?b.innerHTML=c:b.appendChild(c);return b}function x(b,
c){b.state.currentNotificationClose&&b.state.currentNotificationClose();b.state.currentNotificationClose=c}function y(b,c){var a=c.keyCode||c.which,f=e.keyMap["default"]===e.keyMap.pcDefault;f=c.metaKey&&!c.ctrlKey&&!f||c.ctrlKey&&f;72!=a||!f||c.altKey||c.shiftKey?70==a&&f&&c.altKey&&!c.shiftKey?(b.execCommand("replace"),c.stopPropagation(),c.preventDefault()):70!=a||!f||c.altKey||c.shiftKey?71!=a||!f||c.shiftKey||c.altKey?71==a&&f&&c.shiftKey&&!c.altKey?(b.execCommand("findPrev"),c.stopPropagation(),
c.preventDefault()):76!=a||!f||c.shiftKey||c.altKey||(b.execCommand("goToLine"),c.stopPropagation(),c.preventDefault()):(b.execCommand("findNext"),c.stopPropagation(),c.preventDefault()):(b.execCommand("find"),c.stopPropagation(),c.preventDefault()):(b.execCommand("replace"),c.stopPropagation(),c.preventDefault())}e.defineExtension("searchReplaceDialog",function(b,c,a){function f(d){if("string"==typeof d)h.value=d;else if(!u&&(u=!0,k.parentNode.removeChild(k),q.focus(),a.onClose))a.onClose(k)}a||
(a={});var l=this.getWrapperElement().querySelector(".CodeMirror-dialog");if(l){var p=document.createElement("div");p.innerHTML=b;p=p.childNodes[0];var t="."+p.className.replace(/[\s]+/g,".");if((t=l.querySelector(t))&&t.className==p.className){var h=l.getElementsByTagName("input")[0];null!=a.value&&(h.value=a.value);h.select();return}}x(this,f);var k=z(this,b,a.bottom);a.ignoreCase&&(b=document.createElement("span"),b.setAttribute("class","ignore-case"),b.innerHTML="\x3cinput type\x3d'checkbox' id\x3d'ignoreCase'  class\x3d'custom-ds-hidden'/\x3e\x3clabel for\x3d'ignoreCase'\x3eAa\x3c/label\x3e",
k.querySelector(".find-input-div").appendChild(b),k.querySelector(".custom-deluge-search #findBtn").style="padding-right:38px",k.querySelector("#replacementText").style="width:315px");var u=!1,q=this,g=k.querySelector("#findBtn"),m=k.querySelector("#replacementText");b=k.querySelector("#delugeReplaceBtn");var w=k.querySelector("#delugeReplaceAllBtn"),r=k.querySelector("#ignoreCase");l=k.querySelector("#closeDiv");var v=!1,n=!0;if(g){g.focus();a.value&&(g.value=a.value,!1!==a.selectValueOnOpen&&g.select());
if(a.onInput)e.on(g,"input",function(d){a.onInput(d,g.value,f)});if(a.onKeyUp)e.on(g,"keyup",function(d){a.onKeyUp(d,g.value,f)});if(a.clear)e.on(g,"keyup",function(d){a.clear(d,g.value,null)});e.on(g,"keydown",function(d){var c=d.keyCode||d.which;if(!(a&&a.onKeyDown&&a.onKeyDown(d,g.value,f))){if(27==c||!1!==a.closeOnEnter&&13==c)g.blur(),e.e_stop(d),f();9==c&&d.shiftKey?(w.focus(),d.preventDefault()):(y(q,d),r&&1==r.checked&&(n=!1),13==c&&(a.findFunction(g.value,n,d),d.preventDefault()))}});if(!1!==
a.closeOnBlur)e.on(g,"blur",f)}if(m){a.replacementQuery&&(m.value=a.replacementQuery);if(a.clear)e.on(m,"keyup",function(d){a.clear(d,null,m.value)});e.on(m,"keydown",function(d){var b=d.keyCode||d.which;if(!(a&&a.onKeyDown&&a.onKeyDown(d,m.value,f))){if(27==b||!1!==a.closeOnEnter&&13==b)m.blur(),e.e_stop(d),f();9!=b||d.shiftKey?(y(q,d),v=!1,n=!0,r&&1==r.checked&&(n=!1),d.altKey&&13==b?(c(g.value,m.value,v,n,d,!0),d.preventDefault()):d.shiftKey&&13==b?(c(g.value,m.value,!0,n,d),d.preventDefault()):
d.shiftKey||d.altKey||13!=b||(c(g.value,m.value,v,n,d),d.preventDefault())):(g.focus(),d.preventDefault())}});if(!1!==a.closeOnBlur)e.on(m,"blur",f)}b&&(w&&(e.on(w,"click",function(d){r&&1==r.checked&&(n=!1);a.replaceAction(g.value,m.value,!0,n,d)}),e.on(w,"keydown",function(a){9!=(a.keyCode||a.which)||a.shiftKey||(g.focus(),a.preventDefault())})),e.on(b,"click",function(b){v=!1;n=!0;r&&1==r.checked&&(n=!1);a.replaceAction(g.value,m.value,v,n,b);b.preventDefault()}));if(l)e.on(l,"click",function(){f();
q.focus()});return f});e.defineExtension("searchDialog",function(b,c,a){function f(b){if("string"==typeof b)h.value=b;else if(!u&&(u=!0,k.parentNode.removeChild(k),q.focus(),a.onClose))a.onClose(k)}a||(a={});var l=this.getWrapperElement().querySelector(".CodeMirror-dialog");if(l){var p=document.createElement("div");p.innerHTML=b;p=p.childNodes[0];var t="."+p.className.replace(/[\s]+/g,".");if((t=l.querySelector(t))&&t.className==p.className){var h=l.getElementsByTagName("input")[0];null!=a.value&&
(h.value=a.value);h.select();return}}x(this,f);var k=z(this,b,a.bottom);a.ignoreCase&&(b=document.createElement("span"),b.setAttribute("class","ignore-case"),b.innerHTML="\x3cinput type\x3d'checkbox' id\x3d'ignoreCase'  class\x3d'custom-ds-hidden'/\x3e\x3clabel for\x3d'ignoreCase'\x3eAa\x3c/label\x3e",document.querySelector(".find-input-div").insertBefore(b,document.querySelector(".find-input-div .close-icon")),document.querySelector(".custom-deluge-search #findBtn").style="padding-right:40px");var u=
!1,q=this;h=k.getElementsByTagName("input")[0];var g=k.querySelector("#ignoreCase");l=k.querySelector("#closeDiv");if(h){h.focus();a.value&&(h.value=a.value,!1!==a.selectValueOnOpen&&h.select());if(a.onInput)e.on(h,"input",function(b){a.onInput(b,h.value,f)});if(a.onKeyUp)e.on(h,"keyup",function(b){a.onKeyUp(b,h.value,f)});if(a.clear)e.on(h,"keyup",function(b){a.clear(b,h.value,null)});e.on(h,"keydown",function(b){var k=b.keyCode||b.which;if(!(a&&a.onKeyDown&&a.onKeyDown(b,h.value,f))){if(27==k||
!1!==a.closeOnEnter&&13==k)h.blur(),e.e_stop(b),f();y(q,b);ignoreCase=!0;g&&1==g.checked&&(ignoreCase=!1);13==b.keyCode&&(c(h.value,ignoreCase,b),b.preventDefault())}});if(!1!==a.closeOnBlur)e.on(h,"blur",f)}else if(b=k.getElementsByTagName("button")[0]){e.on(b,"click",function(){f();q.focus()});if(!1!==a.closeOnBlur)e.on(b,"blur",f);b.focus()}if(l)e.on(l,"click",function(){f();q.focus()});return f});e.commands.closeNotification=function(b){x(b)}});